var Directives;(function(n){var t=function(){function n(){}return n.ToHex=function(n){var t=n.toString(16);return t.length==1?"0"+t:t},n.MakeSvg=function(n,t){var r=document.createElementNS("http://www.w3.org/2000/svg",n),i;for(i in t)r.setAttribute(i,t[i]);return r},n.Factory=function(t,i){var f,u,r;return{restrict:"E",template:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1"><rect x="0" y="0" width="'+Constants.Display.CanvasXMax+'" height="'+Constants.Display.CanvasYMax+'" style="fill:white;"/><\/svg>',scope:{},link:function(e,o){var o=angular.element(o),k=[16,64,112,160,208,255],nt=[16,56,96,136,176,216,255],s,d,h,g,c,l,a,v,p,w,b,tt=$(o).get(0).childNodes[0],y;for(t.log("Initializing the display..."),f=angular.copy(i.pixels),u=[],r=[],l=0;l<6;l+=1)for(a=0;a<7;a+=1)for(v=0;v<6;v+=1)p=k[l],b=nt[a],w=k[v],c=(l*7+a)*6+v,c===0&&(p=b=w=0),r[c]="#"+n.ToHex(p)+n.ToHex(b)+n.ToHex(w);for(r[251]="#111111",r[252]="#555555",r[253]="#999999",r[254]="#cccccc",r[255]="#ffffff",t.log("Palette has been generated."),h=0;h<Constants.Display.YMax;h+=1)for(s=0;s<Constants.Display.XMax;s+=1)c=h*Constants.Display.XMax+s,d=s*Constants.Display.XFactor,g=h*Constants.Display.YFactor,y=n.MakeSvg("rect",{x:d,y:g,width:Constants.Display.XFactor,height:Constants.Display.YFactor}),y.setAttribute("style","fill:"+r[0]),u[c]=y,tt.appendChild(y);t.log("Built pixel map."),i.callback=function(n,t){var i=n&Constants.Display.Max,e=t&Constants.Memory.ByteMask;f[i]=e,u[i].removeAttribute("style"),u[i].setAttribute("style","fill:"+r[e])},t.log("Display initialized.")}}},n}();n.Display=t,Main.App.Directives.directive("display",["consoleService","displayService",t.Factory])})(Directives||(Directives={}))